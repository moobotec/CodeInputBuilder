if("undefined"==typeof jQuery)throw new Error("La bibliothèque jQuery est requise pour que CodeInputBuilder fonctionne. Veuillez inclure jQuery avant de charger cette bibliothèque.");!function(t){t.fn.codeInputBuilder=function(e){const n=function(e){const n=t.extend({},{type:"integer",numInputs:1,minValues:[],maxValues:[],values:[],defaultValue:0,allowSign:!1,defaultSign:"+",decimalPosition:1,separator:".",totalMax:null,totalMin:null,onValueChange:null,allowScroll:!0,scrollSensitivity:50,requireKeyForScroll:null,autoFocusNextInput:!1,autoFocusNextInputDirection:null,gap:"10px"},e);return function(){if(!["integer","float","text"].includes(n.type))throw new Error("Option 'type' invalide. Valeurs autorisées : 'integer', 'float', 'text'.");if("number"!=typeof n.numInputs||n.numInputs<1)throw new Error("Option 'numInputs' doit être un entier positif.");if("text"!==n.type&&Array.isArray(n.minValues)&&n.minValues.length!==n.numInputs)throw new Error("'minValues' doit contenir autant d'éléments que 'numInputs'.");if("text"!==n.type&&Array.isArray(n.maxValues)&&n.maxValues.length!==n.numInputs)throw new Error("'maxValues' doit contenir autant d'éléments que 'numInputs'.");if("float"===n.type&&("number"!=typeof n.decimalPosition||n.decimalPosition<1))throw new Error("Option 'decimalPosition' doit être un entier positif pour les types flottants.");if("number"!=typeof n.defaultValue&&"string"!=typeof n.defaultValue)throw new Error("Option 'defaultValue' doit être un nombre ou une chaîne.");if(null!==n.totalMin&&"number"!=typeof n.totalMin)throw new Error("Option 'totalMin' doit être un nombre ou null.");if(null!==n.totalMax&&"number"!=typeof n.totalMax)throw new Error("Option 'totalMax' doit être un nombre ou null.");if(null!==n.onValueChange&&"function"!=typeof n.onValueChange)throw new Error("Option 'onValueChange' doit être une fonction ou null.");if("boolean"!=typeof n.allowScroll)throw new Error("Option 'allowScroll' doit être un booléen.");if("boolean"!=typeof n.autoFocusNextInput)throw new Error("Option 'autoFocusNextInput' doit être un booléen.");if(n.autoFocusNextInputDirection&&!["Forward","Backward","Right","Left"].includes(n.autoFocusNextInputDirection))throw new Error("Option 'autoFocusNextInputDirection' doit être 'Forward', 'Backward', 'Right', 'Left' ou null.");if("number"!=typeof n.scrollSensitivity||n.scrollSensitivity<=0)throw new Error("Option 'scrollSensitivity' doit être un entier positif.");if(n.requireKeyForScroll&&!["Control","Shift","Alt","Meta"].includes(n.requireKeyForScroll))throw new Error("Option 'requireKeyForScroll' doit être 'Control', 'Shift', 'Alt', 'Meta' ou null.")}(),n}(e);let l=null,o=0,i=9,a={value:"",digits:new Array(n.numInputs).fill(0),sign:n.allowSign?n.defaultSign:null,indexList:-1},u=void 0!==n.totalMin&&null!=n.totalMin?w(n.totalMin):null,r=void 0!==n.totalMax&&null!=n.totalMax?w(n.totalMax):null,s=n.type+"_"+"xxxxxxxx".replace(/[x]/g,(function(){return(16*Math.random()|0).toString(16)}));function p(t,e){if("sign"===t)a.sign=e;else if("list"===t)a.indexList=e;else if("current"===t)a.value=e;else if("fillDigits"===t)a.digits.fill(e);else{if(isNaN(t))throw new Error("Index invalide :",t);a.digits[t]=e}}function c(t){return"sign"===t?a.sign:"list"===t?a.indexList:"current"===t?a.value:"digits"===t?a.digits:isNaN(t)?null:a.digits[t]}function d(t,e){return t.indexOf(e)}function f(e){return{valueMin:parseInt(t(e).attr("data-min"),10),valueMax:parseInt(t(e).attr("data-max"),10)}}function h(e,l){if(isNaN(e))return;let a=e;"number"==typeof n.totalMin&&null!==n.totalMin&&a<n.totalMin&&(a=n.totalMin),"number"==typeof n.totalMax&&null!==n.totalMax&&a>n.totalMax&&(a=n.totalMax),n.allowSign&&t(`[id^="sign_${l}_input"]`).val(a<0?"-":"+");let u,r,s=Math.abs(a).toString();if("float"===n.type){[u,r]=s.split("."),u=u.padStart(n.decimalPosition,"0");const t=n.numInputs-n.decimalPosition;r=(r||"").slice(0,t).padEnd(t,"0")}else{if("integer"!==n.type)throw new Error("Type non supporté dans la fonction fillDigits.");u=s,r=""}const c=t(`[id^="digits_${l}_input_"]`).get();let d=c.length-1;c.forEach((e=>t(e).val(0)));for(let e of(u+r).split("").reverse()){const{value:l}=$(d,e,n,o,i);t(c[d]).val(l),p(d,l),d--}}function m(e){let l=function(e){let l="";return t("input[id^=digits_"+e+"_input]").each((function(e){"float"===n.type&&e===n.decimalPosition&&(l+="."),l+=t(this).val()})),l}(e);return l=v(l,e),"float"===n.type?parseFloat(l):parseInt(l,10)}function v(e,l){if(!n.allowSign)return e;const o=t("input[id^=sign_"+l+"_input]"),i=o.length?o.val():"+";return"string"==typeof e?"-"===i?"-"+e:e:"number"==typeof e&&"-"===i?-e:e}function g(t,e,l,o=!0){let i="text"===n.type?e:m(l);if(p("current",i),"integer"===n.type||"float"===n.type){const{totalMin:t,totalMax:e}=n;null!=t&&i<=t?p("current",t):null!=e&&i>=e&&p("current",e),i!==c("current")&&h(c("current"),l)}o&&"function"==typeof n.onValueChange&&n.onValueChange(t,c("current"))}function x(e,n,l,o,i,a){t(".cla-input-wrapper .top-text-"+e+"-"+n).css("visibility","hidden"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("visibility","hidden"),t(".cla-input-wrapper .top-text-"+e+"-"+n).css("opacity","0"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("opacity","0"),l&&(t(".cla-input-wrapper .top-text-"+e+"-"+n).css("visibility","visible"),t(".cla-input-wrapper .top-text-"+e+"-"+n).html(i),t(".cla-input-wrapper .top-text-"+e+"-"+n).css("opacity","1")),o&&(t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("visibility","visible"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).html(a),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("opacity","1"))}function w(t){const e=t.toString().replace(".","");let l=Array.from(e,(t=>parseInt(t,10)));for(;l.length<n.numInputs;)l.push(0);return l.slice(0,n.numInputs)}function y(t,e=!1,n=0){let l=t.map((t=>t.toString())).join("");return 1==e&&n<t.length&&(l=l.slice(0,n)+"."+l.slice(n)),parseFloat(l)}function _(e,o,i,a){const s="digits"===i?t(e).attr("id").replace(`${i}_${a}_input_`,""):i,d=a+("digits"===i?s:i),h={digits:()=>(p(s-1,o),o),sign:()=>(p("sign",o),o),list:()=>{const t=n.values[o];return p("list",t),t}},m=h[i]?h[i]():"";e.value=m,g(t(e),m,a);const v=function(t,e,o,i,a){if(a!==l)return{index:-1,showTop:!1,showBottom:!1,adjustedValueTop:0,adjustedValueBottom:0};const s={digits:()=>{const l=y(c(t),"float"===n.type,n.decimalPosition),o=b(i,e,l,u,r);return{index:e,showTop:o.showTop,showBottom:o.showBottom,adjustedValueTop:o.valueTop,adjustedValueBottom:o.valueBottom}},sign:()=>({index:t,showTop:"-"===o,showBottom:"+"===o,adjustedValueTop:"+",adjustedValueBottom:"-"}),list:()=>{const{valueTop:e,valueBottom:l}=V(o),{valueMin:a,valueMax:u}=f(i),r=B(e,l,a,u);return{index:t,showTop:r.showTop,showBottom:r.showBottom,adjustedValueTop:n.values[r.adjustedValueTop],adjustedValueBottom:n.values[r.adjustedValueBottom]}}};return s[t]?s[t]():{index:-1,showTop:!1,showBottom:!1,adjustedValueTop:0,adjustedValueBottom:0}}(i,s,o,e,d);x(a,v.index,v.showTop,v.showBottom,v.adjustedValueTop,v.adjustedValueBottom)}function M(e,l,o,i,a,u=null,r=null){const s=o.ctrlKey&&"paste"===o.key,{valueMin:p,valueMax:c}=f(e);if(o.ctrlKey&&("c"===o.key||67===l)||o.ctrlKey&&("v"===o.key||86===l)||!o.ctrlKey&&17===l)o.preventDefault();else if("digits"===i)if(l>=48&&l<=48+c||l>=96&&l<=96+c&&!s||8===l||9===l||46===l){if(8===l)_(e,p,i,a),u-1==0&&(u=r+1),t("#"+i+"_"+a+"_input_"+(u-1)).focus();else if(46===l)_(e,p,i,a),u+1===r+1&&(u=0),t("#"+i+"_"+a+"_input_"+(u+1)).focus();else if(9!==l){const r=e.value.slice(-1);if(/^[0-9]$/.test(r)){let r=o.key;s&&(r=function(t){return String.fromCharCode(t)}(l)),_(e,r,i,a),t("#"+i+"_"+a+"_input_"+function(t,e){let n=t;if(!0===e.autoFocusNextInput&&null!==e.autoFocusNextInputDirection)switch(e.autoFocusNextInputDirection){case"Forward":case"Right":n+=1;break;case"Backward":case"Left":n-=1;break;default:console.warn(`Direction "${e.autoFocusNextInputDirection}" non reconnue. L'index reste inchangé.`)}return n}(u,n)).focus()}else _(e,e.value.slice(0,-1),i,a)}}else _(e,p,i,a),o.preventDefault();else"sign"===i&&("+"===o.key||"-"===o.key?_(e,o.key,i,a):9!==l&&(_(e,"+",i,a),o.preventDefault()))}function V(t){const e=parseInt(t,10);return{valueTop:e-1,valueBottom:e+1}}function b(e,l,o,i,a){let{valueTop:u,valueBottom:r}=V(t(e).val());void 0!==n.totalMax&&null!==n.totalMax&&o>=n.totalMax&&(u=parseInt(a[l-1])-1),void 0!==n.totalMin&&null!==n.totalMin&&o<=n.totalMin&&(r=parseInt(i[l-1])+1);let{valueMin:s,valueMax:p}=f(e);s=Math.max(s,n.totalMin??-1/0),p=Math.min(p,n.totalMax??1/0),void 0!==n.totalMin&&null!==n.totalMin&&o<=n.totalMin&&(s=Math.max(s,i[l-1])),void 0!==n.totalMax&&null!==n.totalMax&&o>=n.totalMax&&(p=Math.min(p,a[l-1]));return{valueTop:u,valueBottom:r,valueMin:s,valueMax:p,showTop:u>=s,showBottom:r<=p}}function I(t,e=null,n=null,l,o){if(null===e&&null===n){return{adjustedValue:Math.max(l,Math.min(t,o))}}const i=null!==e?Math.max(e,l):null,a=null!==n?Math.min(n,o):null;return null!==e&&null===n?{adjustedValueTop:i}:null!==n&&null===e?{adjustedValueBottom:a}:{adjustedValueTop:i,adjustedValueBottom:a}}function B(t,e,n,l){const o=t>=n,i=e<=l,{adjustedValueTop:a,adjustedValueBottom:u}=I(null,t,e,n,l);return{showTop:o,showBottom:i,adjustedValueTop:a,adjustedValueBottom:u}}function T(e,n,l,o){const i=t(e).attr("id").replace(`${n}_${l}_div_`,""),a=i.includes("top")?"top":"bottom",u=i.replace(`${a}_`,"");t(`.cla-input-wrapper .${a}-text-${l}-${u}`).css({visibility:o?"visible":"hidden",opacity:o?"1":"0"})}function $(t,e=null,n,l,o){const i=void 0!==n.minValues[t]?Math.max(l,Math.min(n.minValues[t],o)):l,a=void 0!==n.maxValues[t]?Math.max(l,Math.min(n.maxValues[t],o)):o;let u=null!=e?e:void 0!==n.values[t]?n.values[t]:n.defaultValue;return u=Math.max(i,Math.min(u,a)),{min:i,max:a,value:u}}function j(e,o,i,a,s){return t("<div>",{class:null!=i?`cla-hover-text ${a}-text-${o}-${i}`:`cla-hover-text ${a}-text-${o}`,id:null!=i?`${e}_${o}_div_${a}_${i}`:`${e}_${o}_div_${a}`,text:s}).hover((function(){T(this,e,o,!0)}),(function(){T(this,e,o,!1)})).on("click",(function(){!function(e,o,i){let a,s,p,c,h,m=t(e).attr("id").replace(o+"_"+i+"_div_","");if("digits"==o)if(m.includes("top")){a=m.replace("top_","");const{valueMin:n}=f("#"+o+"_"+i+"_input_"+a);s=parseInt(t(e).html()),t("#"+o+"_"+i+"_input_"+a).val(s),g(t("#"+o+"_"+i+"_input_"+a),s,i),l=i+a,p=s-1,h=b(t("#"+o+"_"+i+"_input_"+a),a,p,u,r),x(i,a,h.showTop,!1,h.valueTop,0),l=null}else a=m.replace("bottom_",""),s=parseInt(t(e).html()),t("#"+o+"_"+i+"_input_"+a).val(s),g(t("#"+o+"_"+i+"_input_"+a),s,i),l=i+a,c=s+1,h=b(t("#"+o+"_"+i+"_input_"+a),a,c,u,r),x(i,a,!1,h.showBottom,0,h.valueBottom),l=null;else if("sign"==o)t("#"+o+"_"+i+"_input_"+o).val(t(e).html()),g(t("#"+o+"_"+i+"_input_"+o),t(e).html(),i),l=i+o,x(i,o,!1,!1,0,0),l=null;else if("list"==o){const{valueMin:a,valueMax:u}=f("#"+o+"_"+i+"_input_"+o);t("#"+o+"_"+i+"_input_"+o).val(t(e).html()),g(t("#"+o+"_"+i+"_input_"+o),t(e).html(),i),l=i+o;let r=d(n.values,t(e).html());m.includes("top")?(p=r-1,h=B(p,0,a,0),x(i,o,h.showTop,!1,n.values[h.adjustedValueTop],"...")):(c=r+1,h=B(0,c,0,u),x(i,o,!1,h.showBottom,"...",n.values[h.adjustedValueBottom])),l=null}}(this,e,o)}))}function S(e,o,i,a,s,p,h="1",m=!1){const v=t("<input>",{type:"text",class:`form-control form-control-lg text-center cla-h2-like ${e}-input`,maxLength:h,id:null!=i?`${e}_${o}_input_${i}`:`${e}_${o}_input`,name:null!=i?`${e}${i}`:`${e}`,autocomplete:"off",value:p,"data-min":a,"data-max":s,disabled:m?"disabled":null});return v.on("keyup",(t=>function(t,e,n,l,o=null,i=null){const a=e.originalEvent||e,u=a.keyCode||a.which;16!==u&&M(t,u,a,n,l,o,i)}(t.currentTarget,t,e,o,i,n.numInputs))).on("wheel",(t=>function(t,e,l,o){if(!n.allowScroll)return;const i=t.originalEvent||t;if(i.preventDefault(),n.requireKeyForScroll){const e=n.requireKeyForScroll.toLowerCase();if("control"===e&&!t.ctrlKey||"shift"===e&&!t.shiftKey||"alt"===e&&!t.altKey||"meta"===e&&!t.metaKey)return}const a=void 0!==i.deltaY?i.deltaY:i.wheelDelta?-i.wheelDelta:0;if(!(Math.abs(a)<n.scrollSensitivity))if("digits"==l){let t=parseInt(e.value,10);if(-1!=t){t+=a<0?-1:1;const{valueMin:n,valueMax:i}=f(e),{adjustedValue:u}=I(t,null,null,n,i);t=u,_(e,t,l,o)}}else if("sign"==l){let t=-1;"-"==e.value&&(t=0),"+"==e.value&&(t=1),-1!=t&&(t+=a<0?-1:1,t<0&&_(e,"+",l,o),t>1&&_(e,"-",l,o))}else if("list"==l){let t=d(n.values,e.value);if(-1!=t){t+=a<0?-1:1;const{valueMin:n,valueMax:i}=f(e),{adjustedValue:u}=I(t,null,null,n,i);t=u,_(e,t,l,o)}}}(t,t.currentTarget,e,o))).hover((function(){!function(e,o,i){let a=parseInt(t(e).attr("id").replace(o+"_"+i+"_input_",""));if("digits"==o){l=i+a;let t=b(e,a,c("current"),u,r);x(i,a,t.showTop,t.showBottom,t.valueTop,t.valueBottom)}else if("sign"==o)l=i+o,x(i,o,"-"==t(e).val(),"+"==t(e).val(),"+","-");else if("list"==o){l=i+o;let t=d(n.values,e.value);if(console.log(t),-1!=t){const l=parseInt(t)-1,a=parseInt(t)+1,{valueMin:u,valueMax:r}=f(e);let s=B(l,a,u,r);x(i,o,s.showTop,s.showBottom,n.values[s.adjustedValueTop],n.values[s.adjustedValueBottom])}}}(this,e,o)}),(function(){!function(e,n,o){"digits"==n?x(o,t(e).attr("id").replace(n+"_"+o+"_input_",""),!1,!1,0,0):"sign"!=n&&"list"!=n||x(o,n,!1,!1,0,0);l=null}(this,e,o)})).on("paste",(l=>function(e,l,o,i){const a=l.originalEvent||l;a.preventDefault();let u=a.clipboardData.getData("text");u.length>1&&(u=u.substring(0,1));let r=u.charCodeAt(0);a.ctrlKey=!0,a.key="paste";let s=t(e).attr("id").replace(`${i}_${o}_input_`,"");applyCode(e,r,a,i,o,s,n.numInputs)}(this,l,o,e))).on("copy",(e=>{e.preventDefault(),navigator.clipboard.writeText(t(this).val())})),v}return this.each((function(){const e=t(this),l=t("<div>",{class:"cla-input-container",css:{display:"flex","justify-content":"center","align-items":"center",gap:n.gap}});function a(e,n,o,i,a,u="1",r=!1){const p=t("<div>",{class:"text-center cla-input-wrapper",css:{position:"relative"}});p.append(j(e,s,n,"top",o??"...")),p.append(S(e,s,n,o,i,a,u,r)),p.append(j(e,s,n,"bottom",o??"...")),l.append(p)}if("integer"===n.type||"float"===n.type){n.allowSign&&a("sign","sign",null,null,c("sign"));for(let e=1;e<=n.numInputs;e++){"float"===n.type&&e-1===n.decimalPosition&&l.append(t("<div>",{class:"col-1",html:`<div><h2 class="my-5">${n.separator}</h2></div>`}));const{min:u,max:r,value:s}=$(e-1,null,n,o,i);a("digits",e,u,r,s),p(e-1,s)}e.append(l);for(let e=1;e<=n.numInputs;e++){const l="digits",{value:a}=$(e-1,null,n,o,i);g(t("#"+l+"_"+s+"_input_"+e),a,s,!1)}}else"text"===n.type&&(a("list","list",0,n.values.length-1,n.values[n.defaultValue],"30",!0),e.append(l),p("current",n.values[n.defaultValue]))})),this.getCompleteValue=function(){return c("current")},this.getDigitAt=function(t){if("integer"===n.type||"float"===n.type){if(t>=0&&t<currentDigit.length){const e=c(t);return parseInt(e,10)}throw new Error("L'index est en dehors de la plage")}throw new Error("settings.type non disponible avec la fonction getDigitAt")},this.setCompleteValue=function(e,l=!1){if("integer"===n.type||"float"===n.type){if(!/^[-+]?\d+(\.\d+)?$/.test(e))throw new Error("La valeur doit être un nombre flottant ou un entier.");{p("fillDigits",0),h(e,s);let t=y(c("digits"),"float"===n.type,n.decimalPosition);t=v(t,s),p("current",t),l&&"function"==typeof n.onValueChange&&n.onValueChange(null,c("current"))}}else{if("text"!==n.type)throw new Error("Le type spécifié dans settings n'est pas compatible avec setCompleteValue.");if(-1===d(n.values,e))throw new Error("Le texte n'est pas reconnu dans les valeurs disponibles.");t("#list_"+s+"_input").val(e),p("current",e),l&&"function"==typeof n.onValueChange&&n.onValueChange(null,c("current"))}},this},t.fn.codeInputBuilder.version="0.0.6",t.fn.codeInputBuilder.title="CodeInputBuilder",t.fn.codeInputBuilder.description="Un plugin jQuery pour créer des champs d'input configurables pour des valeurs numériques ou flottantes et pour les textes."}(jQuery);