if("undefined"==typeof jQuery)throw new Error("La bibliothèque jQuery est requise pour que CodeInputBuilder fonctionne. Veuillez inclure jQuery avant de charger cette bibliothèque.");!function(t){t.fn.codeInputBuilder=function(e){const n=function(e){const n=t.extend({},{type:"integer",numInputs:1,minValues:[],maxValues:[],values:[],defaultValue:0,allowSign:!1,defaultSign:"+",decimalPosition:1,separator:".",totalMax:null,totalMin:null,onValueChange:null,allowScroll:!0,scrollSensitivity:50,requireKeyForScroll:null,gap:"10px"},e);return function(){if(!["integer","float","text"].includes(n.type))throw new Error("Option 'type' invalide. Valeurs autorisées : 'integer', 'float', 'text'.");if("number"!=typeof n.numInputs||n.numInputs<1)throw new Error("Option 'numInputs' doit être un entier positif.");if("text"!==n.type&&Array.isArray(n.minValues)&&n.minValues.length!==n.numInputs)throw new Error("'minValues' doit contenir autant d'éléments que 'numInputs'.");if("text"!==n.type&&Array.isArray(n.maxValues)&&n.maxValues.length!==n.numInputs)throw new Error("'maxValues' doit contenir autant d'éléments que 'numInputs'.");if("float"===n.type&&("number"!=typeof n.decimalPosition||n.decimalPosition<1))throw new Error("Option 'decimalPosition' doit être un entier positif pour les types flottants.");if("number"!=typeof n.defaultValue&&"string"!=typeof n.defaultValue)throw new Error("Option 'defaultValue' doit être un nombre ou une chaîne.");if(null!==n.totalMin&&"number"!=typeof n.totalMin)throw new Error("Option 'totalMin' doit être un nombre ou null.");if(null!==n.totalMax&&"number"!=typeof n.totalMax)throw new Error("Option 'totalMax' doit être un nombre ou null.");if(null!==n.onValueChange&&"function"!=typeof n.onValueChange)throw new Error("Option 'onValueChange' doit être une fonction ou null.");if("boolean"!=typeof n.allowScroll)throw new Error("Option 'allowScroll' doit être un booléen.");if("number"!=typeof n.scrollSensitivity||n.scrollSensitivity<=0)throw new Error("Option 'scrollSensitivity' doit être un entier positif.");if(n.requireKeyForScroll&&!["Control","Shift","Alt","Meta"].includes(n.requireKeyForScroll))throw new Error("Option 'requireKeyForScroll' doit être 'Control', 'Shift', 'Alt', 'Meta' ou null.")}(),n}(e);let l=null,o=0,a=9,u={value:"",digits:new Array(n.numInputs).fill(0),sign:n.allowSign?n.defaultSign:null,indexList:-1},r=void 0!==n.totalMin&&null!=n.totalMin?w(n.totalMin):null,s=void 0!==n.totalMax&&null!=n.totalMax?w(n.totalMax):null,p=n.type+"_"+"xxxxxxxx".replace(/[x]/g,(function(){return(16*Math.random()|0).toString(16)}));function c(t,e){if("sign"===t)u.sign=e;else if("list"===t)u.indexList=e;else if("current"===t)u.value=e;else if("fillDigits"===t)u.digits.fill(e);else{if(isNaN(t))throw new Error("Index invalide :",t);u.digits[t]=e}}function d(t){return"sign"===t?u.sign:"list"===t?u.indexList:"current"===t?u.value:"digits"===t?u.digits:isNaN(t)?null:u.digits[t]}function f(t,e){return t.indexOf(e)}function m(e){return{valueMin:parseInt(t(e).attr("data-min"),10),valueMax:parseInt(t(e).attr("data-max"),10)}}function h(e,l){if(isNaN(e))return;let i=e;"number"==typeof n.totalMin&&null!==n.totalMin&&i<n.totalMin&&(i=n.totalMin),"number"==typeof n.totalMax&&null!==n.totalMax&&i>n.totalMax&&(i=n.totalMax),n.allowSign&&t(`[id^="sign_${l}_input"]`).val(i<0?"-":"+");let u,r,s=Math.abs(i).toString();if("float"===n.type){[u,r]=s.split("."),u=u.padStart(n.decimalPosition,"0");const t=n.numInputs-n.decimalPosition;r=(r||"").slice(0,t).padEnd(t,"0")}else{if("integer"!==n.type)throw new Error("Type non supporté dans la fonction fillDigits.");u=s,r=""}const p=t(`[id^="digits_${l}_input_"]`).get();let d=p.length-1;p.forEach((e=>t(e).val(0)));for(let e of(u+r).split("").reverse()){const{value:l}=$(d,e,n,o,a);t(p[d]).val(l),c(d,l),d--}}function v(e){let l=function(e){let l="";return t("input[id^=digits_"+e+"_input]").each((function(e){"float"===n.type&&e===n.decimalPosition&&(l+="."),l+=t(this).val()})),l}(e);return l=g(l,e),"float"===n.type?parseFloat(l):parseInt(l,10)}function g(e,l){if(!n.allowSign)return e;const o=t("input[id^=sign_"+l+"_input]"),i=o.length?o.val():"+";return"string"==typeof e?"-"===i?"-"+e:e:"number"==typeof e&&"-"===i?-e:e}function y(t,e,l,o=!0){let i="text"===n.type?e:v(l);if(c("current",i),"integer"===n.type||"float"===n.type){const{totalMin:t,totalMax:e}=n;null!=t&&i<=t?c("current",t):null!=e&&i>=e&&c("current",e),i!==d("current")&&h(d("current"),l)}o&&"function"==typeof n.onValueChange&&n.onValueChange(t,d("current"))}function x(e,n,l,o,i,a){t(".cla-input-wrapper .top-text-"+e+"-"+n).css("visibility","hidden"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("visibility","hidden"),t(".cla-input-wrapper .top-text-"+e+"-"+n).css("opacity","0"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("opacity","0"),l&&(t(".cla-input-wrapper .top-text-"+e+"-"+n).css("visibility","visible"),t(".cla-input-wrapper .top-text-"+e+"-"+n).html(i),t(".cla-input-wrapper .top-text-"+e+"-"+n).css("opacity","1")),o&&(t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("visibility","visible"),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).html(a),t(".cla-input-wrapper .bottom-text-"+e+"-"+n).css("opacity","1"))}function w(t){const e=t.toString().replace(".","");let l=Array.from(e,(t=>parseInt(t,10)));for(;l.length<n.numInputs;)l.push(0);return l.slice(0,n.numInputs)}function _(t,e=!1,n=0){let l=t.map((t=>t.toString())).join("");return 1==e&&n<t.length&&(l=l.slice(0,n)+"."+l.slice(n)),parseFloat(l)}function M(e,o,i,a){const u="digits"===i?t(e).attr("id").replace(`${i}_${a}_input_`,""):i,p=a+("digits"===i?u:i),f={digits:()=>(c(u-1,o),o),sign:()=>(c("sign",o),o),list:()=>{const t=n.values[o];return c("list",t),t}},h=f[i]?f[i]():"";e.value=h,y(t(e),h,a);const v=function(t,e,o,i,a){if(a!==l)return{index:-1,showTop:!1,showBottom:!1,adjustedValueTop:0,adjustedValueBottom:0};const u={digits:()=>{const l=_(d(t),"float"===n.type,n.decimalPosition),o=B(i,e,l,r,s);return{index:e,showTop:o.showTop,showBottom:o.showBottom,adjustedValueTop:o.valueTop,adjustedValueBottom:o.valueBottom}},sign:()=>({index:t,showTop:"-"===o,showBottom:"+"===o,adjustedValueTop:"+",adjustedValueBottom:"-"}),list:()=>{const{valueTop:e,valueBottom:l}=b(o),{valueMin:a,valueMax:u}=m(i),r=j(e,l,a,u);return{index:t,showTop:r.showTop,showBottom:r.showBottom,adjustedValueTop:n.values[r.adjustedValueTop],adjustedValueBottom:n.values[r.adjustedValueBottom]}}};return u[t]?u[t]():{index:-1,showTop:!1,showBottom:!1,adjustedValueTop:0,adjustedValueBottom:0}}(i,u,o,e,p);x(a,v.index,v.showTop,v.showBottom,v.adjustedValueTop,v.adjustedValueBottom)}function V(e,n,l,o,i,a=null,u=null){const r=l.ctrlKey&&"paste"===l.key,{valueMin:s,valueMax:p}=m(e);if(l.ctrlKey&&("c"===l.key||67===n)||l.ctrlKey&&("v"===l.key||86===n)||!l.ctrlKey&&17===n)l.preventDefault();else if("digits"===o)if(n>=48&&n<=48+p||n>=96&&n<=96+p&&!r||8===n||9===n||46===n){if(8===n)M(e,s,o,i),a-2==0&&(a=u+2),t("#"+o+"_"+i+"_input_"+(a-2)).focus();else if(46===n)M(e,s,o,i),a+1===u+2&&(a=1),t("#"+o+"_"+i+"_input_"+a).focus();else if(9!==n){const u=e.value.slice(-1);if(/^[0-9]$/.test(u)){let u=l.key;r&&(u=function(t){return String.fromCharCode(t)}(n)),M(e,u,o,i),t("#"+o+"_"+i+"_input_"+a).focus()}else M(e,e.value.slice(0,-1),o,i)}}else M(e,s,o,i),l.preventDefault();else"sign"===o&&("+"===l.key||"-"===l.key?M(e,l.key,o,i):9!==n&&(M(e,"+",o,i),l.preventDefault()))}function b(t){const e=parseInt(t,10);return{valueTop:e-1,valueBottom:e+1}}function B(e,l,o,i,a){let{valueTop:u,valueBottom:r}=b(t(e).val());void 0!==n.totalMax&&null!==n.totalMax&&o>=n.totalMax&&(u=parseInt(a[l-1])-1),void 0!==n.totalMin&&null!==n.totalMin&&o<=n.totalMin&&(r=parseInt(i[l-1])+1);let{valueMin:s,valueMax:p}=m(e);s=Math.max(s,n.totalMin??-1/0),p=Math.min(p,n.totalMax??1/0),void 0!==n.totalMin&&null!==n.totalMin&&o<=n.totalMin&&(s=Math.max(s,i[l-1])),void 0!==n.totalMax&&null!==n.totalMax&&o>=n.totalMax&&(p=Math.min(p,a[l-1]));return{valueTop:u,valueBottom:r,valueMin:s,valueMax:p,showTop:u>=s,showBottom:r<=p}}function T(t,e=null,n=null,l,o){if(null===e&&null===n){return{adjustedValue:Math.max(l,Math.min(t,o))}}const i=null!==e?Math.max(e,l):null,a=null!==n?Math.min(n,o):null;return null!==e&&null===n?{adjustedValueTop:i}:null!==n&&null===e?{adjustedValueBottom:a}:{adjustedValueTop:i,adjustedValueBottom:a}}function j(t,e,n,l){const o=t>=n,i=e<=l,{adjustedValueTop:a,adjustedValueBottom:u}=T(null,t,e,n,l);return{showTop:o,showBottom:i,adjustedValueTop:a,adjustedValueBottom:u}}function I(e,n,l,o){const i=t(e).attr("id").replace(`${n}_${l}_div_`,""),a=i.includes("top")?"top":"bottom",u=i.replace(`${a}_`,"");t(`.cla-input-wrapper .${a}-text-${l}-${u}`).css({visibility:o?"visible":"hidden",opacity:o?"1":"0"})}function $(t,e=null,n,l,o){const i=void 0!==n.minValues[t]?Math.max(l,Math.min(n.minValues[t],o)):l,a=void 0!==n.maxValues[t]?Math.max(l,Math.min(n.maxValues[t],o)):o;let u=null!=e?e:void 0!==n.values[t]?n.values[t]:n.defaultValue;return u=Math.max(i,Math.min(u,a)),{min:i,max:a,value:u}}function S(e,o,i,a,u){return t("<div>",{class:null!=i?`cla-hover-text ${a}-text-${o}-${i}`:`cla-hover-text ${a}-text-${o}`,id:null!=i?`${e}_${o}_div_${a}_${i}`:`${e}_${o}_div_${a}`,text:u}).hover((function(){I(this,e,o,!0)}),(function(){I(this,e,o,!1)})).on("click",(function(){!function(e,o,i){let a,u,p,c,d,h=t(e).attr("id").replace(o+"_"+i+"_div_","");if("digits"==o)if(h.includes("top")){a=h.replace("top_","");const{valueMin:n}=m("#"+o+"_"+i+"_input_"+a);u=parseInt(t(e).html()),t("#"+o+"_"+i+"_input_"+a).val(u),y(t("#"+o+"_"+i+"_input_"+a),u,i),l=i+a,p=u-1,d=B(t("#"+o+"_"+i+"_input_"+a),a,p,r,s),x(i,a,d.showTop,!1,d.valueTop,0),l=null}else a=h.replace("bottom_",""),u=parseInt(t(e).html()),t("#"+o+"_"+i+"_input_"+a).val(u),y(t("#"+o+"_"+i+"_input_"+a),u,i),l=i+a,c=u+1,d=B(t("#"+o+"_"+i+"_input_"+a),a,c,r,s),x(i,a,!1,d.showBottom,0,d.valueBottom),l=null;else if("sign"==o)t("#"+o+"_"+i+"_input_"+o).val(t(e).html()),y(t("#"+o+"_"+i+"_input_"+o),t(e).html(),i),l=i+o,x(i,o,!1,!1,0,0),l=null;else if("list"==o){const{valueMin:a,valueMax:u}=m("#"+o+"_"+i+"_input_"+o);t("#"+o+"_"+i+"_input_"+o).val(t(e).html()),y(t("#"+o+"_"+i+"_input_"+o),t(e).html(),i),l=i+o;let r=f(n.values,t(e).html());h.includes("top")?(p=r-1,d=j(p,0,a,0),x(i,o,d.showTop,!1,n.values[d.adjustedValueTop],"...")):(c=r+1,d=j(0,c,0,u),x(i,o,!1,d.showBottom,"...",n.values[d.adjustedValueBottom])),l=null}}(this,e,o)}))}function E(e,o,a,u,p,c,h="1",v=!1){const g=t("<input>",{type:"text",class:`form-control form-control-lg text-center cla-h2-like ${e}-input`,maxLength:h,id:null!=a?`${e}_${o}_input_${a}`:`${e}_${o}_input`,name:null!=a?`${e}${a}`:`${e}`,autocomplete:"off",value:c,"data-min":u,"data-max":p,disabled:v?"disabled":null});return g.on("keyup",(t=>function(t,e,n,l,o=null,i=null){const a=e.originalEvent||e,u=a.keyCode||a.which;16!==u&&V(t,u,a,n,l,o,i)}(t.currentTarget,t,e,o,i))).on("wheel",(t=>function(t,e,l,o){if(!n.allowScroll)return;const i=t.originalEvent||t;if(i.preventDefault(),n.requireKeyForScroll){const e=n.requireKeyForScroll.toLowerCase();if("control"===e&&!t.ctrlKey||"shift"===e&&!t.shiftKey||"alt"===e&&!t.altKey||"meta"===e&&!t.metaKey)return}const a=void 0!==i.deltaY?i.deltaY:i.wheelDelta?-i.wheelDelta:0;if(!(Math.abs(a)<n.scrollSensitivity))if("digits"==l){let t=parseInt(e.value,10);if(-1!=t){t+=a<0?-1:1;const{valueMin:n,valueMax:i}=m(e),{adjustedValue:u}=T(t,null,null,n,i);t=u,M(e,t,l,o)}}else if("sign"==l){let t=-1;"-"==e.value&&(t=0),"+"==e.value&&(t=1),-1!=t&&(t+=a<0?-1:1,t<0&&M(e,"+",l,o),t>1&&M(e,"-",l,o))}else if("list"==l){let t=f(n.values,e.value);if(-1!=t){t+=a<0?-1:1;const{valueMin:n,valueMax:i}=m(e),{adjustedValue:u}=T(t,null,null,n,i);t=u,M(e,t,l,o)}}}(t,t.currentTarget,e,o))).hover((function(){!function(e,o,i){let a=parseInt(t(e).attr("id").replace(o+"_"+i+"_input_",""));if("digits"==o){l=i+a;let t=B(e,a,d("current"),r,s);x(i,a,t.showTop,t.showBottom,t.valueTop,t.valueBottom)}else if("sign"==o)l=i+o,x(i,o,"-"==t(e).val(),"+"==t(e).val(),"+","-");else if("list"==o){l=i+o;let t=f(n.values,e.value);if(console.log(t),-1!=t){const l=parseInt(t)-1,a=parseInt(t)+1,{valueMin:u,valueMax:r}=m(e);let s=j(l,a,u,r);x(i,o,s.showTop,s.showBottom,n.values[s.adjustedValueTop],n.values[s.adjustedValueBottom])}}}(this,e,o)}),(function(){!function(e,n,o){"digits"==n?x(o,t(e).attr("id").replace(n+"_"+o+"_input_",""),!1,!1,0,0):"sign"!=n&&"list"!=n||x(o,n,!1,!1,0,0);l=null}(this,e,o)})).on("paste",(l=>function(e,l,o,i,a){const u=l.originalEvent||l;u.preventDefault();let r=u.clipboardData.getData("text");r.length>1&&(r=r.substring(0,1));let s=r.charCodeAt(0);u.ctrlKey=!0,u.key="paste";let p=t(e).attr("id").replace(a+"_","");applyCode(e,s,u,i,o,p,n.numInputs)}(this,l,o,e,`${e}_${o}_input`))).on("copy",(e=>{e.preventDefault(),navigator.clipboard.writeText(t(this).val())})),g}return this.each((function(){const e=t(this),l=t("<div>",{class:"cla-input-container",css:{display:"flex","justify-content":"center","align-items":"center",gap:n.gap}});function i(e,n,o,i,a,u="1",r=!1){const s=t("<div>",{class:"text-center cla-input-wrapper",css:{position:"relative"}});s.append(S(e,p,n,"top",o??"...")),s.append(E(e,p,n,o,i,a,u,r)),s.append(S(e,p,n,"bottom",o??"...")),l.append(s)}if("integer"===n.type||"float"===n.type){n.allowSign&&i("sign","sign",null,null,d("sign"));for(let e=1;e<=n.numInputs;e++){"float"===n.type&&e-1===n.decimalPosition&&l.append(t("<div>",{class:"col-1",html:`<div><h2 class="my-5">${n.separator}</h2></div>`}));const{min:u,max:r,value:s}=$(e-1,null,n,o,a);i("digits",e,u,r,s),c(e-1,s)}e.append(l);for(let e=1;e<=n.numInputs;e++){const l="digits",{value:i}=$(e-1,null,n,o,a);y(t("#"+l+"_"+p+"_input_"+e),i,p,!1)}}else"text"===n.type&&(i("list","list",0,n.values.length-1,n.values[n.defaultValue],"30",!0),e.append(l),c("current",n.values[n.defaultValue]))})),this.getCompleteValue=function(){return d("current")},this.getDigitAt=function(t){if("integer"===n.type||"float"===n.type){if(t>=0&&t<currentDigit.length){const e=d(t);return parseInt(e,10)}throw new Error("L'index est en dehors de la plage")}throw new Error("settings.type non disponible avec la fonction getDigitAt")},this.setCompleteValue=function(e,l=!1){if("integer"===n.type||"float"===n.type){if(!/^[-+]?\d+(\.\d+)?$/.test(e))throw new Error("La valeur doit être un nombre flottant ou un entier.");{c("fillDigits",0),h(e,p);let t=_(d("digits"),"float"===n.type,n.decimalPosition);t=g(t,p),c("current",t),l&&"function"==typeof n.onValueChange&&n.onValueChange(null,d("current"))}}else{if("text"!==n.type)throw new Error("Le type spécifié dans settings n'est pas compatible avec setCompleteValue.");if(-1===f(n.values,e))throw new Error("Le texte n'est pas reconnu dans les valeurs disponibles.");t("#list_"+p+"_input").val(e),c("current",e),l&&"function"==typeof n.onValueChange&&n.onValueChange(null,d("current"))}},this},t.fn.codeInputBuilder.version="0.0.5",t.fn.codeInputBuilder.title="CodeInputBuilder",t.fn.codeInputBuilder.description="Un plugin jQuery pour créer des champs d'input configurables pour des valeurs numériques ou flottantes et pour les textes."}(jQuery);